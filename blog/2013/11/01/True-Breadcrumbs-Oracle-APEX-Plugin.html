<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		
		<link href="../../../../_app/immutable/assets/0.CeAKPTyx.css" rel="stylesheet">
		<link href="../../../../_app/immutable/assets/2.0064yJqm.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/start.C79-xvMf.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/entry.DaZGqSlT.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/runtime.BZuNgBny.js">
		<link rel="modulepreload" href="../../../../_app/immutable/entry/app.D8fn-cW0.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/render.CeUcSJ3F.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/svelte-head.BoBMsJEW.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/disclose-version.BZtIaq82.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/if.Cocn_Tq8.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/store.DX2XIyjU.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/0.DYHUpUh2.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/snippet.Cy8K4we5.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/2.D9cpv9Rn.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/legacy.CtV6FHWp.js">
		<link rel="modulepreload" href="../../../../_app/immutable/nodes/11.DVKsNjJ7.js">
		<link rel="modulepreload" href="../../../../_app/immutable/chunks/html.BY5OYTWt.js">
	</head>
	<body>
		<div><!--[--><!--[--><!----><!--[--><!----><div class="svelte-1yjh0wm"><header><h1 class="svelte-1yjh0wm">Mark Temple-Heald</h1> <h2 class="svelte-1yjh0wm">the right tool for the job</h2></header> <nav class="svelte-z3ooaf"><ul class="svelte-z3ooaf"><li class="svelte-z3ooaf"><a href="/" class="navAnchor">Home</a></li> <li class="svelte-z3ooaf"><a href="/blog" class="navAnchor">Blog</a></li> <li class="svelte-z3ooaf"><a href="/topic" class="navAnchor">Topic</a></li> <li class="svelte-z3ooaf"><a href="/about" class="navAnchor">About</a></li></ul></nav><!----></div><!----> <main class="svelte-1l5lemn"><!----><p>I was getting irritated with breadcrumbs in APEX, specifically having to maintain a separate list for both breadcrumbs and “normal” navigation.<br> What I wanted was:</p> <ul><li>every time you moved to a new page, remember the previous one as a parent</li> <li>if you move to a page you’d already been to, reset to that point.</li></ul> <p>So when a new version of APEX came out, I looked into the new plug-in development feature, this is the result.</p> <p>The idea is simple, consisting of the following elements:</p> <ul><li>Add a Region to Page 0 of the application referencing the plug-in, this renders a new breadcrumb element on each render (page load)</li> <li>Add navigation to the application <ul><li>I used a list (which has no notion of breadcrumbs), implemented on each page for demonstration purposes</li> <li>This could equally well be chart navigation, interactive reports, etc</li></ul></li> <li>An APEX collection to store the current state of the breadcrumbs</li></ul> <p>For the record, I’m not suggesting that this is a particularly good approach, it doesn’t cater for session state management and it is another server process to execute, which will obviously affect performance, but <a href="https://apex.oracle.com/pls/apex/f?p=55790:1::::::" rel="nofollow">it works</a>.</p> <h3>Creating a Plug-In</h3> <p>Creating a plug-in is as simple as creating a package which exposes a function with the right signature, in this case, for a Region plug-in:</p> <pre class="language-sql"><!----><code class="language-sql"><span class="token keyword">FUNCTION</span> render <span class="token punctuation">(</span>p_region              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_region
                <span class="token punctuation">,</span>p_plugin              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_plugin
                <span class="token punctuation">,</span>p_is_printer_friendly <span class="token operator">IN</span> <span class="token keyword">BOOLEAN</span><span class="token punctuation">)</span>
  <span class="token keyword">RETURN</span> apex_plugin<span class="token punctuation">.</span>t_region_render_result</code><!----></pre> <p>Implementing the plug-in is even easier, simply add a plug-in Shared Component to the application, referencing the PL/SQL package, in this case:
Render Procedure/Function Name = true_breadcrumbs.render</p> <h3>The Code</h3> <h5>Page 0 Region Position 02 (didn’t have to be here)</h5> <ul><li>Identification > Title: True Breadcrumbs</li> <li>Identification > Type: True Breadcrumbs [Plug-In]</li> <li>Header and Footer > Header Text (this is only a demo, I wouldn’t normally add CSS directly in the HTML)</li></ul> <pre class="language-html"><!----><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">ul.true_breadcrumbs</span> <span class="token punctuation">&#123;</span>
    <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token selector">ul.true_breadcrumbs li</span> <span class="token punctuation">&#123;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token selector">ul.true_breadcrumbs li:before</span> <span class="token punctuation">&#123;</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">" > "</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token selector">ul.true_breadcrumbs li:first-child:before</span> <span class="token punctuation">&#123;</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></code><!----></pre> <h5>Package header</h5> <pre class="language-sql"><!----><code class="language-sql"><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> PACKAGE true_breadcrumbs <span class="token keyword">AS</span>

  <span class="token keyword">FUNCTION</span> render <span class="token punctuation">(</span>p_region              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_region
                  <span class="token punctuation">,</span>p_plugin              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_plugin
                  <span class="token punctuation">,</span>p_is_printer_friendly <span class="token operator">IN</span> <span class="token keyword">BOOLEAN</span><span class="token punctuation">)</span>
    <span class="token keyword">RETURN</span> apex_plugin<span class="token punctuation">.</span>t_region_render_result<span class="token punctuation">;</span>

<span class="token keyword">END</span> true_breadcrumbs<span class="token punctuation">;</span></code><!----></pre> <h5>Package body</h5> <pre class="language-sql"><!----><code class="language-sql"><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> PACKAGE BODY true_breadcrumbs <span class="token keyword">AS</span>
<span class="token comment">/**
%usage   Set of program units which work together to provide an easily-implemented breadcrumb solution without manual development effort
%usage   Designed to be implemented on a global page ("page 0")
%usage   Displayed by default on all pages except 101 (login), other popups can be excluded by altering the conditional display settings
%author  Mark Temple-Heald
%version 1.0  25-JAN-2014 Initial version
*/</span>
  <span class="token keyword">CURSOR</span> c_breadcrumbs <span class="token operator">IS</span>
    <span class="token keyword">SELECT</span> N001 application_id
    <span class="token punctuation">,</span>      N002 page_id
    <span class="token punctuation">,</span>      C001 page_name
    <span class="token punctuation">,</span>      seq_id
    <span class="token keyword">FROM</span>   apex_collections
    <span class="token keyword">WHERE</span>  collection_name <span class="token operator">=</span> <span class="token string">'TRUE_BREADCRUMBS'</span>
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> seq_id<span class="token punctuation">;</span>

<span class="token comment">/**
%usage   Use the ApEx data dictionary to obtain the page name from the page id, for use as a breadcrumb label
*/</span>
  <span class="token keyword">FUNCTION</span> get_page_name <span class="token punctuation">(</span>p_application_id <span class="token operator">IN</span> apex_application_pages<span class="token punctuation">.</span>application_id<span class="token operator">%</span><span class="token keyword">TYPE</span>
                         <span class="token punctuation">,</span>p_page_id        <span class="token operator">IN</span> apex_application_pages<span class="token punctuation">.</span>page_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">)</span>
    <span class="token keyword">RETURN</span> apex_application_pages<span class="token punctuation">.</span>page_name<span class="token operator">%</span><span class="token keyword">TYPE</span>
  <span class="token operator">IS</span>
    v_page_name apex_application_pages<span class="token punctuation">.</span>page_name<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span>
  <span class="token keyword">BEGIN</span>

    <span class="token keyword">SELECT</span> page_name
    <span class="token keyword">INTO</span>   v_page_name
    <span class="token keyword">FROM</span>   apex_application_pages
    <span class="token keyword">WHERE</span>  application_id <span class="token operator">=</span> p_application_id
    <span class="token operator">AND</span>    page_id        <span class="token operator">=</span> p_page_id<span class="token punctuation">;</span>

    <span class="token keyword">RETURN</span> v_page_name<span class="token punctuation">;</span>

  <span class="token keyword">END</span> get_page_name<span class="token punctuation">;</span>

<span class="token comment">/**
%usage   Update the breadcrumb collection to produce the shortest path from source to the current breadcrumb
*/</span>
  <span class="token keyword">PROCEDURE</span> update_breadcrumbs <span class="token punctuation">(</span>p_application_id <span class="token operator">IN</span> apex_application_pages<span class="token punctuation">.</span>application_id<span class="token operator">%</span><span class="token keyword">TYPE</span>
                               <span class="token punctuation">,</span>p_page_id        <span class="token operator">IN</span> apex_application_pages<span class="token punctuation">.</span>page_id<span class="token operator">%</span><span class="token keyword">TYPE</span>
                               <span class="token punctuation">,</span>p_page_name      <span class="token operator">IN</span> apex_application_pages<span class="token punctuation">.</span>page_name<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">)</span>
  <span class="token operator">IS</span>
    v_found <span class="token keyword">BOOLEAN</span> :<span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">;</span>
    v_seq_id NUMBER<span class="token punctuation">;</span>
  <span class="token keyword">BEGIN</span>
    <span class="token comment">-- create collection if it doesn't already exist</span>
    <span class="token comment">-- list of pages visited in chronological order starting with the first page visited (where this region plug-in is displayed)</span>
    <span class="token comment">-- N001 = APP_ID, N002 = APP_PAGE_ID, C001 = Breadcrumb title/ page name</span>
    <span class="token keyword">IF</span> <span class="token operator">NOT</span> apex_collection<span class="token punctuation">.</span>collection_exists <span class="token punctuation">(</span><span class="token string">'TRUE_BREADCRUMBS'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
      apex_collection<span class="token punctuation">.</span>create_collection <span class="token punctuation">(</span><span class="token string">'TRUE_BREADCRUMBS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

    <span class="token keyword">IF</span> p_page_id <span class="token operator">=</span> <span class="token number">101</span> <span class="token keyword">THEN</span>

      <span class="token comment">-- the login page should not appear in breadcrumbs, so the next page visited will be home</span>
      apex_collection<span class="token punctuation">.</span>truncate_collection <span class="token punctuation">(</span><span class="token string">'TRUE_BREADCRUMBS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">ELSE</span>

      <span class="token keyword">FOR</span> i <span class="token operator">IN</span> c_breadcrumbs <span class="token keyword">LOOP</span>

        <span class="token keyword">IF</span> v_found <span class="token keyword">THEN</span>
          <span class="token comment">-- within this loop we've already encountered this page, so delete breadcrumbs further down the trail</span>
          apex_collection<span class="token punctuation">.</span>delete_member <span class="token punctuation">(</span><span class="token string">'TRUE_BREADCRUMBS'</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span>seq_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
        <span class="token keyword">IF</span> i<span class="token punctuation">.</span>application_id <span class="token operator">=</span> p_application_id <span class="token operator">AND</span>
           i<span class="token punctuation">.</span>page_id        <span class="token operator">=</span> p_page_id
        <span class="token keyword">THEN</span>
          <span class="token comment">-- we have already visited this page within this session, so mark for delete of everything further down the breacrumb trail</span>
          v_found :<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">;</span>
        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

      <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span>

      <span class="token keyword">IF</span> <span class="token operator">NOT</span> v_found <span class="token keyword">THEN</span>

        v_seq_id :<span class="token operator">=</span> apex_collection<span class="token punctuation">.</span>add_member <span class="token punctuation">(</span>p_collection_name <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'TRUE_BREADCRUMBS'</span>
                                               <span class="token punctuation">,</span>p_n001            <span class="token operator">=</span><span class="token operator">></span> p_application_id
                                               <span class="token punctuation">,</span>p_n002            <span class="token operator">=</span><span class="token operator">></span> p_page_id
                                               <span class="token punctuation">,</span>p_c001            <span class="token operator">=</span><span class="token operator">></span> p_page_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

  <span class="token keyword">END</span> update_breadcrumbs<span class="token punctuation">;</span>
<span class="token comment">/**
%usage   Produce HTML to represent the breadcrumbs, based on what is stored in the global associative array
*/</span>
  <span class="token keyword">FUNCTION</span> make_html
    <span class="token keyword">RETURN</span> VARCHAR2
  <span class="token operator">IS</span>
    v_html VARCHAR2<span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">BEGIN</span>
    v_html :<span class="token operator">=</span> <span class="token string">'&lt;ul class="true_breadcrumbs">'</span><span class="token punctuation">;</span>
    <span class="token keyword">FOR</span> i <span class="token operator">IN</span> c_breadcrumbs <span class="token keyword">LOOP</span>
      v_html :<span class="token operator">=</span> v_html <span class="token operator">||</span> <span class="token string">'&lt;li>&lt;a href="f?p='</span><span class="token operator">||</span>i<span class="token punctuation">.</span>application_id<span class="token operator">||</span><span class="token string">':'</span><span class="token operator">||</span>i<span class="token punctuation">.</span>page_id<span class="token operator">||</span><span class="token string">':'</span><span class="token operator">||</span>V<span class="token punctuation">(</span><span class="token string">'APP_SESSION'</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'">'</span><span class="token operator">||</span>i<span class="token punctuation">.</span>page_name<span class="token operator">||</span><span class="token string">'&lt;/a>&lt;/li>'</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span>
    v_html :<span class="token operator">=</span> v_html <span class="token operator">||</span> <span class="token string">'&lt;/ul>'</span><span class="token punctuation">;</span>
    <span class="token keyword">RETURN</span> v_html<span class="token punctuation">;</span>
  <span class="token keyword">END</span> make_html<span class="token punctuation">;</span>
<span class="token comment">/**
%usage   Function implementing the region plug-in interface which produces breadcrumbs in unstyled HTML
%usage   The first time this is called (the first page accessed within this application) will act as the home breadcrumb
%usage   Any page accessed which is not currently in the trail will be added.
%usage   Any page revisited will become the new current breadcrumb, truncating crumbs further down the trail
*/</span>
  <span class="token keyword">FUNCTION</span> render <span class="token punctuation">(</span>p_region              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_region
                  <span class="token punctuation">,</span>p_plugin              <span class="token operator">IN</span> apex_plugin<span class="token punctuation">.</span>t_plugin
                  <span class="token punctuation">,</span>p_is_printer_friendly <span class="token operator">IN</span> <span class="token keyword">BOOLEAN</span><span class="token punctuation">)</span>
    <span class="token keyword">RETURN</span> apex_plugin<span class="token punctuation">.</span>t_region_render_result
  <span class="token operator">IS</span>
    v_application_id apex_application_pages<span class="token punctuation">.</span>application_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span>
    v_page_id        apex_application_pages<span class="token punctuation">.</span>page_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span>
    v_page_name      apex_application_pages<span class="token punctuation">.</span>page_name<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span>
    v_return         apex_plugin<span class="token punctuation">.</span>t_region_render_result<span class="token punctuation">;</span>
  <span class="token keyword">BEGIN</span>

    <span class="token keyword">IF</span> apex_application<span class="token punctuation">.</span>g_debug <span class="token keyword">THEN</span>
      apex_plugin_util<span class="token punctuation">.</span>debug_region <span class="token punctuation">(</span>p_plugin<span class="token punctuation">,</span> p_region<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

    v_application_id :<span class="token operator">=</span> NV<span class="token punctuation">(</span><span class="token string">'APP_ID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v_page_id        :<span class="token operator">=</span> NV<span class="token punctuation">(</span><span class="token string">'APP_PAGE_ID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v_page_name      :<span class="token operator">=</span> get_page_name <span class="token punctuation">(</span>v_application_id<span class="token punctuation">,</span> v_page_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    update_breadcrumbs <span class="token punctuation">(</span>v_application_id<span class="token punctuation">,</span> v_page_id<span class="token punctuation">,</span> v_page_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sys<span class="token punctuation">.</span>htp<span class="token punctuation">.</span>p <span class="token punctuation">(</span>make_html<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">RETURN</span> v_return<span class="token punctuation">;</span>

  <span class="token keyword">END</span> render<span class="token punctuation">;</span>

<span class="token keyword">END</span> true_breadcrumbs<span class="token punctuation">;</span>
</code><!----></pre><!----><!----></main> <footer class="svelte-1g9mmpv"><p>This is my site, there are many like it but this one is mine.</p> <p>If you don't like it, you know where the close button is.</p> <a href="https://www.linkedin.com/in/mtempleheald" target="_blank" class="svelte-1g9mmpv">Mark Temple-Heald</a> <a href="https://mtempleheald.github.io" target="_blank" class="svelte-1g9mmpv">Home</a> <a href="https://github.com/mtempleheald" target="_blank" class="svelte-1g9mmpv">GitHub</a> <p>Mindful meanderings manifest more manageable machinations. Manoeuvring murky multifaceted
		modernism means meticulously managing many mistakes, misconceptions, misunderstandings. Measured
		multipronged musings, mechanical movements, may maximise meritorious magnificence.</p></footer><!----><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1fqzuke = {
						base: new URL("../../../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null,null];

					Promise.all([
						import("../../../../_app/immutable/entry/start.C79-xvMf.js"),
						import("../../../../_app/immutable/entry/app.D8fn-cW0.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 11],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
