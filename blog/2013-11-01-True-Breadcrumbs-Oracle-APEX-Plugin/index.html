<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<meta http-equiv="content-security-policy" content="">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-711b4112.css">
	<link rel="modulepreload" href="/_app/start-e82316e2.js">
	<link rel="modulepreload" href="/_app/chunks/vendor-5ca848cc.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-8da8bfc2.js">
	<link rel="modulepreload" href="/_app/pages/blog/_slug_.svelte-db98abb9.js">
	</head>
	<body>
		<div>



<div class="svelte-1lrvsco"><header><h1 class="svelte-1lrvsco">Mark Temple-Heald</h1>
  <h2 class="svelte-1lrvsco">the right tool for the job</h2></header>

<nav class="svelte-r02kv1"><ul class="svelte-r02kv1"><li class="svelte-r02kv1"><a href="/" class="navAnchor">Home</a></li>
    <li class="svelte-r02kv1"><a href="/blog" class="navAnchor">Blog</a></li>
    <li class="svelte-r02kv1"><a href="/topic" class="navAnchor">Topic</a></li>
    <li class="svelte-r02kv1"><a href="/about" class="navAnchor">About</a></li></ul>
</nav>
</div>

<main class="svelte-lv7236"><!-- HTML_TAG_START -->I was getting irritated with breadcrumbs in APEX, specifically having to maintain a separate list for both breadcrumbs and "normal" navigation.<br />What I wanted was:<ul><li>every time you moved to a new page, remember the previous one as a parent</li><li>if you move to a page you'd already been to, reset to that point.  </li></ul><br />So when a new version of APEX came out, I looked into the new plug-in development feature, this is the result.<br />The idea is simple, consisting of the following elements:<ul><li>Add a Region to Page 0 of the application referencing the plug-in, this renders a new breadcrumb element on each render (page load)</li><li>Add navigation to the application</li></ul><pre class="code poetry"><code>* I used a list (which has no notion of breadcrumbs), implemented on each page for demonstration purposes
* This could equally well be chart navigation, interactive reports, etc</code></pre><ul><li>An APEX collection to store the current state of the breadcrumbs</li></ul><br />For the record, I'm not suggesting that this is a particularly good approach, it doesn't cater for session state management and it is another server process to execute, which will obviously affect performance, but <a href="https://apex.oracle.com/pls/apex/f?p=55790:1::::::">it works</a>.<br /><h3>Creating a Plug-In</h3>Creating a plug-in is as simple as creating a package which exposes a function with the right signature, in this case, for a Region plug-in:
<pre class="code sql"><code class="language-sql">FUNCTION render (p_region              IN apex_plugin.t_region
                ,p_plugin              IN apex_plugin.t_plugin
                ,p_is_printer_friendly IN BOOLEAN)
  RETURN apex_plugin.t_region_render_result</code></pre>
Implementing the plug-in is even easier, simply add a plug-in Shared Component to the application, referencing the PL/SQL package, in this case:
Render Procedure/Function Name = true<em>breadcrumbs.render<h3>The Code</h3><h5>Page 0 Region Position 02 (didn't have to be here)</h5><ul><li>Identification > Title: True Breadcrumbs</li><li>Identification > Type: True Breadcrumbs <a href="undefined">Plug-In</a></li><li>Header and Footer > Header Text (this is only a demo, I wouldn't normally add CSS directly in the HTML)</li></ul><br /><pre class="code html"><code class="language-html">&lt;style type=&quot;text/css&quot;&gt;
  ul.true_breadcrumbs {
    list-style-type: none;
  }
  ul.true_breadcrumbs li {
    display: inline;
  }
  ul.true_breadcrumbs li:before {
    content: &quot; &gt; &quot;;
  }
  ul.true_breadcrumbs li:first-child:before {
    content: &quot;&quot;;
  }
&lt;/style&gt;</code></pre><h5>Package header</h5><pre class="code sql"><code class="language-sql">create or replace PACKAGE true_breadcrumbs AS

  FUNCTION render (p_region              IN apex_plugin.t_region
                  ,p_plugin              IN apex_plugin.t_plugin
                  ,p_is_printer_friendly IN BOOLEAN)
    RETURN apex_plugin.t_region_render_result;
  
END true_breadcrumbs;</code></pre><h5>Package body</h5><pre class="code sql"><code class="language-sql">create or replace PACKAGE BODY true_breadcrumbs AS
/**
%usage   Set of program units which work together to provide an easily-implemented breadcrumb solution without manual development effort
%usage   Designed to be implemented on a global page (&quot;page 0&quot;)
%usage   Displayed by default on all pages except 101 (login), other popups can be excluded by altering the conditional display settings
%author  Mark Temple-Heald
%version 1.0  25-JAN-2014 Initial version   
*/
  CURSOR c_breadcrumbs IS
    SELECT N001 application_id
    ,      N002 page_id
    ,      C001 page_name
    ,      seq_id
    FROM   apex_collections
    WHERE  collection_name = 'TRUE_BREADCRUMBS'
    ORDER BY seq_id;
    
/**
%usage   Use the ApEx data dictionary to obtain the page name from the page id, for use as a breadcrumb label
*/
  FUNCTION get_page_name (p_application_id IN apex_application_pages.application_id%TYPE
                         ,p_page_id        IN apex_application_pages.page_id%TYPE)
    RETURN apex_application_pages.page_name%TYPE
  IS
    v_page_name apex_application_pages.page_name%TYPE;
  BEGIN

    SELECT page_name
    INTO   v_page_name
    FROM   apex_application_pages
    WHERE  application_id = p_application_id
    AND    page_id        = p_page_id;
    
    RETURN v_page_name;
    
  END get_page_name;
  
/**
%usage   Update the breadcrumb collection to produce the shortest path from source to the current breadcrumb
*/
  PROCEDURE update_breadcrumbs (p_application_id IN apex_application_pages.application_id%TYPE
                               ,p_page_id        IN apex_application_pages.page_id%TYPE
                               ,p_page_name      IN apex_application_pages.page_name%TYPE)
  IS
    v_found BOOLEAN := FALSE;
    v_seq_id NUMBER;
  BEGIN
    -- create collection if it doesn't already exist
    -- list of pages visited in chronological order starting with the first page visited (where this region plug-in is displayed)
    -- N001 = APP_ID, N002 = APP_PAGE_ID, C001 = Breadcrumb title/ page name
    IF NOT apex_collection.collection_exists ('TRUE_BREADCRUMBS') THEN
      apex_collection.create_collection ('TRUE_BREADCRUMBS');
    END IF;
    
    IF p_page_id = 101 THEN
      
      -- the login page should not appear in breadcrumbs, so the next page visited will be home
      apex_collection.truncate_collection ('TRUE_BREADCRUMBS');
        
    ELSE

      FOR i IN c_breadcrumbs LOOP
      
        IF v_found THEN
          -- within this loop we've already encountered this page, so delete breadcrumbs further down the trail
          apex_collection.delete_member ('TRUE_BREADCRUMBS', i.seq_id);
        END IF;
        IF i.application_id = p_application_id AND
           i.page_id        = p_page_id
        THEN
          -- we have already visited this page within this session, so mark for delete of everything further down the breacrumb trail
          v_found := TRUE;
        END IF;
        
      END LOOP;

      IF NOT v_found THEN
       
        v_seq_id := apex_collection.add_member (p_collection_name =&gt; 'TRUE_BREADCRUMBS'
                                               ,p_n001            =&gt; p_application_id
                                               ,p_n002            =&gt; p_page_id
                                               ,p_c001            =&gt; p_page_name);
    
      END IF;

    END IF;

  END update_breadcrumbs;
/**
%usage   Produce HTML to represent the breadcrumbs, based on what is stored in the global associative array
*/
  FUNCTION make_html
    RETURN VARCHAR2
  IS
    v_html VARCHAR2(4000);
  BEGIN
    v_html := '&lt;ul class=&quot;true_breadcrumbs&quot;&gt;';
    FOR i IN c_breadcrumbs LOOP
      v_html := v_html || '&lt;li&gt;&lt;a href=&quot;f?p='||i.application_id||':'||i.page_id||':'||V('APP_SESSION')||'&quot;&gt;'||i.page_name||'&lt;/a&gt;&lt;/li&gt;';
    END LOOP;
    v_html := v_html || '&lt;/ul&gt;';
    RETURN v_html;
  END make_html;
/**
%usage   Function implementing the region plug-in interface which produces breadcrumbs in unstyled HTML
%usage   The first time this is called (the first page accessed within this application) will act as the home breadcrumb
%usage   Any page accessed which is not currently in the trail will be added. 
%usage   Any page revisited will become the new current breadcrumb, truncating crumbs further down the trail
*/
  FUNCTION render (p_region              IN apex_plugin.t_region
                  ,p_plugin              IN apex_plugin.t_plugin
                  ,p_is_printer_friendly IN BOOLEAN)
    RETURN apex_plugin.t_region_render_result
  IS
    v_application_id apex_application_pages.application_id%TYPE;
    v_page_id        apex_application_pages.page_id%TYPE;
    v_page_name      apex_application_pages.page_name%TYPE;
    v_return         apex_plugin.t_region_render_result;
  BEGIN
      
    IF apex_application.g_debug THEN
      apex_plugin_util.debug_region (p_plugin, p_region);
    END IF;

    v_application_id := NV('APP_ID');
    v_page_id        := NV('APP_PAGE_ID');
    v_page_name      := get_page_name (v_application_id, v_page_id);
    update_breadcrumbs (v_application_id, v_page_id, v_page_name);
    sys.htp.p (make_html);

    RETURN v_return;

  END render;
  
END true_breadcrumbs;</code></pre></em><!-- HTML_TAG_END --></main>


<footer class="svelte-14g1sgx"><p>This is my site, there are many like it but this one is mine.</p>
  <p>If you don&#39;t like it, you know where the close button is.</p>
  <a href="https://www.linkedin.com/in/mtempleheald" target="_blank" class="svelte-14g1sgx">Mark Temple-Heald</a>
  <a href="https://mtempleheald.github.io" target="_blank" class="svelte-14g1sgx">Home</a>
  <a href="https://github.com/mtempleheald" target="_blank" class="svelte-14g1sgx">GitHub</a>
  <p>Mindful meanderings manifest more manageable machinations.
    Manoeuvring murky multifaceted modernism means meticulously managing many mistakes, misconceptions, misunderstandings.
    Measured multipronged musings, mechanical movements, may maximise meritorious magnificence.
  </p>
</footer>


		<script type="module" data-hydrate="1jyfh4k">
		import { start } from "/_app/start-e82316e2.js";
		start({
			target: document.querySelector('[data-hydrate="1jyfh4k"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-8da8bfc2.js"),
						import("/_app/pages/blog/_slug_.svelte-db98abb9.js")
				],
				url: new URL("http://sveltekit-prerender/blog/2013-11-01-True-Breadcrumbs-Oracle-APEX-Plugin"),
				params: {slug:"2013-11-01-True-Breadcrumbs-Oracle-APEX-Plugin"}
			}
		});
	</script><script type="application/json" data-type="svelte-data" data-url="/api/blogs/2013-11-01-True-Breadcrumbs-Oracle-APEX-Plugin">{"status":200,"statusText":"","headers":{"content-type":"text/plain;charset=UTF-8"},"body":"I was getting irritated with breadcrumbs in APEX, specifically having to maintain a separate list for both breadcrumbs and \"normal\" navigation.  \nWhat I wanted was:\n* every time you moved to a new page, remember the previous one as a parent\n* if you move to a page you'd already been to, reset to that point.  \n\nSo when a new version of APEX came out, I looked into the new plug-in development feature, this is the result.  \n\nThe idea is simple, consisting of the following elements:\n* Add a Region to Page 0 of the application referencing the plug-in, this renders a new breadcrumb element on each render (page load)\n* Add navigation to the application\n    * I used a list (which has no notion of breadcrumbs), implemented on each page for demonstration purposes\n    * This could equally well be chart navigation, interactive reports, etc\n* An APEX collection to store the current state of the breadcrumbs\n\nFor the record, I'm not suggesting that this is a particularly good approach, it doesn't cater for session state management and it is another server process to execute, which will obviously affect performance, but [it works](https:\u002F\u002Fapex.oracle.com\u002Fpls\u002Fapex\u002Ff?p=55790:1::::::).  \n\n### Creating a Plug-In\n\nCreating a plug-in is as simple as creating a package which exposes a function with the right signature, in this case, for a Region plug-in:\n```SQL\nFUNCTION render (p_region              IN apex_plugin.t_region\n                ,p_plugin              IN apex_plugin.t_plugin\n                ,p_is_printer_friendly IN BOOLEAN)\n  RETURN apex_plugin.t_region_render_result\n```\nImplementing the plug-in is even easier, simply add a plug-in Shared Component to the application, referencing the PL\u002FSQL package, in this case:\nRender Procedure\u002FFunction Name = true_breadcrumbs.render\n\n### The Code\n\n##### Page 0 Region Position 02 (didn't have to be here)\n\n* Identification \u003E Title: True Breadcrumbs\n* Identification \u003E Type: True Breadcrumbs [Plug-In]\n* Header and Footer \u003E Header Text (this is only a demo, I wouldn't normally add CSS directly in the HTML)\n\n```HTML\n\u003Cstyle type=\"text\u002Fcss\"\u003E\n  ul.true_breadcrumbs {\n    list-style-type: none;\n  }\n  ul.true_breadcrumbs li {\n    display: inline;\n  }\n  ul.true_breadcrumbs li:before {\n    content: \" \u003E \";\n  }\n  ul.true_breadcrumbs li:first-child:before {\n    content: \"\";\n  }\n\u003C\u002Fstyle\u003E\n```\n\n##### Package header\n\n```SQL\ncreate or replace PACKAGE true_breadcrumbs AS\n\n  FUNCTION render (p_region              IN apex_plugin.t_region\n                  ,p_plugin              IN apex_plugin.t_plugin\n                  ,p_is_printer_friendly IN BOOLEAN)\n    RETURN apex_plugin.t_region_render_result;\n  \nEND true_breadcrumbs;\n```\n\n##### Package body\n```SQL\ncreate or replace PACKAGE BODY true_breadcrumbs AS\n\u002F**\n%usage   Set of program units which work together to provide an easily-implemented breadcrumb solution without manual development effort\n%usage   Designed to be implemented on a global page (\"page 0\")\n%usage   Displayed by default on all pages except 101 (login), other popups can be excluded by altering the conditional display settings\n%author  Mark Temple-Heald\n%version 1.0  25-JAN-2014 Initial version   \n*\u002F\n  CURSOR c_breadcrumbs IS\n    SELECT N001 application_id\n    ,      N002 page_id\n    ,      C001 page_name\n    ,      seq_id\n    FROM   apex_collections\n    WHERE  collection_name = 'TRUE_BREADCRUMBS'\n    ORDER BY seq_id;\n    \n\u002F**\n%usage   Use the ApEx data dictionary to obtain the page name from the page id, for use as a breadcrumb label\n*\u002F\n  FUNCTION get_page_name (p_application_id IN apex_application_pages.application_id%TYPE\n                         ,p_page_id        IN apex_application_pages.page_id%TYPE)\n    RETURN apex_application_pages.page_name%TYPE\n  IS\n    v_page_name apex_application_pages.page_name%TYPE;\n  BEGIN\n\n    SELECT page_name\n    INTO   v_page_name\n    FROM   apex_application_pages\n    WHERE  application_id = p_application_id\n    AND    page_id        = p_page_id;\n    \n    RETURN v_page_name;\n    \n  END get_page_name;\n  \n\u002F**\n%usage   Update the breadcrumb collection to produce the shortest path from source to the current breadcrumb\n*\u002F\n  PROCEDURE update_breadcrumbs (p_application_id IN apex_application_pages.application_id%TYPE\n                               ,p_page_id        IN apex_application_pages.page_id%TYPE\n                               ,p_page_name      IN apex_application_pages.page_name%TYPE)\n  IS\n    v_found BOOLEAN := FALSE;\n    v_seq_id NUMBER;\n  BEGIN\n    -- create collection if it doesn't already exist\n    -- list of pages visited in chronological order starting with the first page visited (where this region plug-in is displayed)\n    -- N001 = APP_ID, N002 = APP_PAGE_ID, C001 = Breadcrumb title\u002F page name\n    IF NOT apex_collection.collection_exists ('TRUE_BREADCRUMBS') THEN\n      apex_collection.create_collection ('TRUE_BREADCRUMBS');\n    END IF;\n    \n    IF p_page_id = 101 THEN\n      \n      -- the login page should not appear in breadcrumbs, so the next page visited will be home\n      apex_collection.truncate_collection ('TRUE_BREADCRUMBS');\n        \n    ELSE\n\n      FOR i IN c_breadcrumbs LOOP\n      \n        IF v_found THEN\n          -- within this loop we've already encountered this page, so delete breadcrumbs further down the trail\n          apex_collection.delete_member ('TRUE_BREADCRUMBS', i.seq_id);\n        END IF;\n        IF i.application_id = p_application_id AND\n           i.page_id        = p_page_id\n        THEN\n          -- we have already visited this page within this session, so mark for delete of everything further down the breacrumb trail\n          v_found := TRUE;\n        END IF;\n        \n      END LOOP;\n\n      IF NOT v_found THEN\n       \n        v_seq_id := apex_collection.add_member (p_collection_name =\u003E 'TRUE_BREADCRUMBS'\n                                               ,p_n001            =\u003E p_application_id\n                                               ,p_n002            =\u003E p_page_id\n                                               ,p_c001            =\u003E p_page_name);\n    \n      END IF;\n\n    END IF;\n\n  END update_breadcrumbs;\n\u002F**\n%usage   Produce HTML to represent the breadcrumbs, based on what is stored in the global associative array\n*\u002F\n  FUNCTION make_html\n    RETURN VARCHAR2\n  IS\n    v_html VARCHAR2(4000);\n  BEGIN\n    v_html := '\u003Cul class=\"true_breadcrumbs\"\u003E';\n    FOR i IN c_breadcrumbs LOOP\n      v_html := v_html || '\u003Cli\u003E\u003Ca href=\"f?p='||i.application_id||':'||i.page_id||':'||V('APP_SESSION')||'\"\u003E'||i.page_name||'\u003C\u002Fa\u003E\u003C\u002Fli\u003E';\n    END LOOP;\n    v_html := v_html || '\u003C\u002Ful\u003E';\n    RETURN v_html;\n  END make_html;\n\u002F**\n%usage   Function implementing the region plug-in interface which produces breadcrumbs in unstyled HTML\n%usage   The first time this is called (the first page accessed within this application) will act as the home breadcrumb\n%usage   Any page accessed which is not currently in the trail will be added. \n%usage   Any page revisited will become the new current breadcrumb, truncating crumbs further down the trail\n*\u002F\n  FUNCTION render (p_region              IN apex_plugin.t_region\n                  ,p_plugin              IN apex_plugin.t_plugin\n                  ,p_is_printer_friendly IN BOOLEAN)\n    RETURN apex_plugin.t_region_render_result\n  IS\n    v_application_id apex_application_pages.application_id%TYPE;\n    v_page_id        apex_application_pages.page_id%TYPE;\n    v_page_name      apex_application_pages.page_name%TYPE;\n    v_return         apex_plugin.t_region_render_result;\n  BEGIN\n      \n    IF apex_application.g_debug THEN\n      apex_plugin_util.debug_region (p_plugin, p_region);\n    END IF;\n\n    v_application_id := NV('APP_ID');\n    v_page_id        := NV('APP_PAGE_ID');\n    v_page_name      := get_page_name (v_application_id, v_page_id);\n    update_breadcrumbs (v_application_id, v_page_id, v_page_name);\n    sys.htp.p (make_html);\n\n    RETURN v_return;\n\n  END render;\n  \nEND true_breadcrumbs;\n\n```"}</script></div>
	</body>
</html>
