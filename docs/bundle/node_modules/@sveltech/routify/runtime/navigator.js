import{get_store_value as t}from"../../../svelte/internal/index.mjs.js";import{currentLocation as e}from"./utils/index.js";import{urlRoute as s,route as o}from"./store.js";import{urlToRoute as r}from"./utils/urlToRoute.js";import{beforeUrlChange as n}from"./helpers.js";function a(n,a){let l=!1;function u(t,n){const i=t||e(),c=r(i),u=[...(n&&r(e())||c).layouts,c];l&&delete l.last,c.last=l,l=c,t||s.set(c),o.set(c),a(u)}const f=function(e){["pushState","replaceState"].forEach((e=>{const s=history[e];history[e]=async function(r={},n,a){const{id:i,path:l,params:u}=t(o);r={id:i,path:l,params:u,...r};const f=new Event(e.toLowerCase());if(Object.assign(f,{state:r,title:n,url:a}),await c(f))return s.apply(this,[r,n,a]),dispatchEvent(f)}}));let s=!1;const r={click:i,pushstate:()=>e(),replacestate:()=>e(),popstate:async t=>{s?s=!1:await c(t)?e():(s=!0,t.preventDefault(),history.go(1))}};Object.entries(r).forEach((t=>addEventListener(...t)));return()=>{Object.entries(r).forEach((t=>removeEventListener(...t)))}}(u);return{updatePage:u,destroy:f}}function i(t){const e=t.target.closest("a"),s=e&&e.getAttribute("href");t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button||t.defaultPrevented||s&&!e.target&&e.host===location.host&&(t.preventDefault(),history.pushState({},"",s))}async function c(e){const s=t(o);for(const t of n._hooks.filter(Boolean)){if(!await t(e,s))return!1}return!0}export{a as init};
//# sourceMappingURL=navigator.js.map
