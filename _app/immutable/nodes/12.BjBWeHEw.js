import{s as Ee,n as te}from"../chunks/scheduler.Cp24rM3s.js";import{S as ze,i as Be,e as s,s as i,H as le,c as a,k as r,a as o,o as ne,r as se,d as l,b as ae,g as n}from"../chunks/index.CkxK-9SL.js";function De(Me){let c,ie=`I was recently involved in an upgrade from BizTalk 2013 to BizTalk 2016.<br/>
After upgrade all of our SpecFlow system tests started failing.`,E,p,oe="The error manifests itself in the Event Viewer Application Logs as:",z,u,B,Pe=`<code class="language-undefined">System.IO.FileNotFoundException: Could not load file or assembly
&#39;Oracle.DataAccess, Version=4.121.1.0, Culture=neutral, PublicKeyToken=89b483f429c47342&#39;
or one of its dependencies. The system cannot find the file specified.</code>`,D,d,re="Dependencies",R,f,ce="So I dug into this in order to understand the problem and how to fix it, it turns out that:",q,v,pe=`<li>Biztalk 2013 has a dependency on <a href="https://www.oracle.com/technetwork/topics/dotnet/index-085163.html" rel="nofollow">Oracle Data Provider for .NET</a> version 11.2.
<ul><li>Oracle version 11.2.0.x.x == Oracle.dataaccess.dll 4.112.x.x</li></ul></li> <li>BizTalk 2016 has the same dependency but on Oracle version 12.1.
<ul><li>Oracle version 12.1.0.x.x == Oracle.dataaccess.dll 4.121.x.x</li></ul></li>`,I,m,ue="When it comes to Oracle database connectivity:",S,b,de="<li>a newer client should be able to connect to an older database</li> <li>an older client may not be able to connect to a newer database</li>",N,x,fe=`In this case the client is the oracle.dataaccess.dll library used by BizTalk, aligned to Oracle database 12.1.<br/>
Well that’s OK then, because our target servers are running Oracle 11.2 which is older.<br/>
At the time of writing there are 3 download options from Oracle’s site:`,g,_,ve="<li>DB version 11gR2 11.2.0.3.20</li> <li>DB version 12cR1 12.1.0.2.4 (closest match, only differs by minor version)</li> <li>DB version 12cR2 12.2.0.1.0</li>",j,C,me="Installation",W,h,be="After installation we end up with the following GACced assemblies:",G,w,V,Oe=`<code class="language-undefined">C:WindowsMicrosoft.NETassemblyGAC_32Oracle.DataAccess\v4.0_4.121.2.0__89b483f429c47342
C:WindowsMicrosoft.NETassemblyGAC_64Oracle.DataAccess\v4.0_4.112.2.0__89b483f429c47342C:WindowsMicrosoft.NETassemblyGAC_32Policy.4.121.Oracle.DataAccess\v4.0_4.121.2.0__89b483f429c47342</code>`,F,T,xe="The last of these provides an assembly bindingRedirect:",U,y,K,Ae='<code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bindingRedirect</span> <span class="token attr-name">oldVersion</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4.121.0.0-4.121.2.0<span class="token punctuation">"</span></span> <span class="token attr-name">newVersion</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4.121.2.0<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code>',X,k,_e=`Great, so BizTalk’s reference to oracle.dataaccess.dll 4.121.1.0 will resolve to 4.121.4.0 and all should be fine.<br/>
Indeed it was.`,J,H,Ce='I’m glad I spent the time investigating this, luckily we didn’t have to follow <a href="https://blog.sandro-pereira.com/2017/10/05/biztalk-server-2016-could-not-load-file-or-assembly-oracle-dataaccess-version-or-one-of-its-dependencies/" rel="nofollow">Sandro Pereira’s advice</a>.',Q,L,he="Testing",Y,M,we=`After installation we have new entries in the %PATH% environment variable:
<code>C:\\oracle\\product\\12.1.0\\client_1</code> <code>C:\\oracle\\product\\12.1.0\\client_1\\bin</code>`,Z,P,Te=`listed before the server installation:
<code>C:\\oraclexe\\app\\oracle\\product\\11.2.0\\server\\bin</code>`,$,O,ye="This means that the client config (TNSNames.ora etc) will be used.",ee,A,ke=`This is important for us to know.<br/>
Our automated system tests against a local XE 11gR2 database (an empty copy of target systems).<br/>
We’d like to be sure that BizTalk, our automated deployment scripts and Systests use the same client versions and configuration where possible.`;return{c(){c=s("p"),c.innerHTML=ie,E=i(),p=s("p"),p.textContent=oe,z=i(),u=s("pre"),B=new le(!1),D=i(),d=s("h3"),d.textContent=re,R=i(),f=s("p"),f.textContent=ce,q=i(),v=s("ul"),v.innerHTML=pe,I=i(),m=s("p"),m.textContent=ue,S=i(),b=s("ul"),b.innerHTML=de,N=i(),x=s("p"),x.innerHTML=fe,g=i(),_=s("ul"),_.innerHTML=ve,j=i(),C=s("h3"),C.textContent=me,W=i(),h=s("p"),h.textContent=be,G=i(),w=s("pre"),V=new le(!1),F=i(),T=s("p"),T.textContent=xe,U=i(),y=s("pre"),K=new le(!1),X=i(),k=s("p"),k.innerHTML=_e,J=i(),H=s("p"),H.innerHTML=Ce,Q=i(),L=s("h3"),L.textContent=he,Y=i(),M=s("p"),M.innerHTML=we,Z=i(),P=s("p"),P.innerHTML=Te,$=i(),O=s("p"),O.textContent=ye,ee=i(),A=s("p"),A.innerHTML=ke,this.h()},l(e){c=a(e,"P",{"data-svelte-h":!0}),r(c)!=="svelte-dyq3a7"&&(c.innerHTML=ie),E=o(e),p=a(e,"P",{"data-svelte-h":!0}),r(p)!=="svelte-yi9o4j"&&(p.textContent=oe),z=o(e),u=a(e,"PRE",{class:!0});var t=ne(u);B=se(t,!1),t.forEach(l),D=o(e),d=a(e,"H3",{"data-svelte-h":!0}),r(d)!=="svelte-14wj9gd"&&(d.textContent=re),R=o(e),f=a(e,"P",{"data-svelte-h":!0}),r(f)!=="svelte-bbjsfz"&&(f.textContent=ce),q=o(e),v=a(e,"UL",{"data-svelte-h":!0}),r(v)!=="svelte-bqjbfk"&&(v.innerHTML=pe),I=o(e),m=a(e,"P",{"data-svelte-h":!0}),r(m)!=="svelte-wfq5rj"&&(m.textContent=ue),S=o(e),b=a(e,"UL",{"data-svelte-h":!0}),r(b)!=="svelte-17nr4p3"&&(b.innerHTML=de),N=o(e),x=a(e,"P",{"data-svelte-h":!0}),r(x)!=="svelte-10a4m33"&&(x.innerHTML=fe),g=o(e),_=a(e,"UL",{"data-svelte-h":!0}),r(_)!=="svelte-1tsvyi0"&&(_.innerHTML=ve),j=o(e),C=a(e,"H3",{"data-svelte-h":!0}),r(C)!=="svelte-1ae8k70"&&(C.textContent=me),W=o(e),h=a(e,"P",{"data-svelte-h":!0}),r(h)!=="svelte-1fqmop7"&&(h.textContent=be),G=o(e),w=a(e,"PRE",{class:!0});var He=ne(w);V=se(He,!1),He.forEach(l),F=o(e),T=a(e,"P",{"data-svelte-h":!0}),r(T)!=="svelte-1f42co1"&&(T.textContent=xe),U=o(e),y=a(e,"PRE",{class:!0});var Le=ne(y);K=se(Le,!1),Le.forEach(l),X=o(e),k=a(e,"P",{"data-svelte-h":!0}),r(k)!=="svelte-pl57pb"&&(k.innerHTML=_e),J=o(e),H=a(e,"P",{"data-svelte-h":!0}),r(H)!=="svelte-1sq22o3"&&(H.innerHTML=Ce),Q=o(e),L=a(e,"H3",{"data-svelte-h":!0}),r(L)!=="svelte-b8tdkm"&&(L.textContent=he),Y=o(e),M=a(e,"P",{"data-svelte-h":!0}),r(M)!=="svelte-1bc4amj"&&(M.innerHTML=we),Z=o(e),P=a(e,"P",{"data-svelte-h":!0}),r(P)!=="svelte-1ibwkw5"&&(P.innerHTML=Te),$=o(e),O=a(e,"P",{"data-svelte-h":!0}),r(O)!=="svelte-1yczsgf"&&(O.textContent=ye),ee=o(e),A=a(e,"P",{"data-svelte-h":!0}),r(A)!=="svelte-ionuhn"&&(A.innerHTML=ke),this.h()},h(){B.a=null,ae(u,"class","language-undefined"),V.a=null,ae(w,"class","language-undefined"),K.a=null,ae(y,"class","language-xml")},m(e,t){n(e,c,t),n(e,E,t),n(e,p,t),n(e,z,t),n(e,u,t),B.m(Pe,u),n(e,D,t),n(e,d,t),n(e,R,t),n(e,f,t),n(e,q,t),n(e,v,t),n(e,I,t),n(e,m,t),n(e,S,t),n(e,b,t),n(e,N,t),n(e,x,t),n(e,g,t),n(e,_,t),n(e,j,t),n(e,C,t),n(e,W,t),n(e,h,t),n(e,G,t),n(e,w,t),V.m(Oe,w),n(e,F,t),n(e,T,t),n(e,U,t),n(e,y,t),K.m(Ae,y),n(e,X,t),n(e,k,t),n(e,J,t),n(e,H,t),n(e,Q,t),n(e,L,t),n(e,Y,t),n(e,M,t),n(e,Z,t),n(e,P,t),n(e,$,t),n(e,O,t),n(e,ee,t),n(e,A,t)},p:te,i:te,o:te,d(e){e&&(l(c),l(E),l(p),l(z),l(u),l(D),l(d),l(R),l(f),l(q),l(v),l(I),l(m),l(S),l(b),l(N),l(x),l(g),l(_),l(j),l(C),l(W),l(h),l(G),l(w),l(F),l(T),l(U),l(y),l(X),l(k),l(J),l(H),l(Q),l(L),l(Y),l(M),l(Z),l(P),l($),l(O),l(ee),l(A))}}}class Ie extends ze{constructor(c){super(),Be(this,c,null,De,Ee,{})}}export{Ie as component};
